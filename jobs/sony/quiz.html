<!DOCTYPE html>
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Sony</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">

  <link rel="stylesheet" href="public/css/normalize.css">
  <link rel="stylesheet" href="public/css/main.css">

  <script src="public/js/vendor/modernizr-2.6.2.min.js"></script>
</head>
<body class="internal quiz">

  <section id="main" class="clearfix">
    <div class="wrapper clearfix">

      <!--questions-->
      <section class="questions">
        <div class="wrapper clearfix">

          <header>
            <span class="current"></span>
            <span class="question"></span>
          </header>

          <div class="holder-timer">
            <div class="holder-spinner">
              <div class="spinner hidden"></div>
              <div class="spinner fill"></div>
            </div>
            <div class="timer visuallyhidden">0</div>
            <div class="totaltime visuallyhidden"></div>
            <div style="float: left;margin-top:20px;">
              <a href="javascript:;" class="btn-pause">Pausar</a>
              <a href="javascript:;" class="btn-skip">Pular</a>
            </div>
          </div>

          <article class="options clearfix">
            <ul class="lst-options">
              <script id="tmpl-options" type="text/x-jquery-tmpl">
              <li class="sprite">
                <a href="javascript:;" class="btn-option clearfix ${$id}" data-value="${AnswerId}">
                  <span class="opt"></span>
                  <span class="label">${TheAnswer}</span>
                </a>
              </li>
              </script>
            </ul>
          </article>
          <input type="hidden" id="hdn-userid" value="dc82d46f-ad98-488b-bd8e-0a8564858759">
          <input type="hidden" name="hdn-correct">
          <a href="javascript:;" class="visuallyhidden submit">responder</a>
          <a href="javascript:;" title="Próxima" class="sprite ir btn-next">Próxima</a>
          <div class="holder-counter">
            <p><span class="current">1</span> de <span class="total">10</span> perguntas</p>
            <ul class="steps">
              <li>1</li>
              <li>2</li>
              <li>3</li>
              <li>4</li>
              <li>5</li>
              <li>6</li>
              <li>7</li>
              <li>8</li>
              <li>9</li>
              <li>10</li>
            </ul>
          </div>
        </div>
      </section>
      <!--questions-->
      <nav class="info">
        <a href="#" class="ir sprite rules">regulamento</a>
        <a href="#" class="ir sprite how-to">como jogar</a>
        <a href="#" class="ir sprite prizes">prêmios</a>
      </nav>
    </div>
  </section>
    <input type="hidden" id="size" value="175" />
  <input type="hidden" id="percent" value="1" />
  <input type="hidden" id="watch" value="60" />
  <script src="public/js/vendor/jquery-1.9.0.min.js"></script>
  <script src="https://raw.github.com/nene/jintervals/master/jintervals.js"></script>
  <script src="http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
  <script src="public/js/vendor/jquery.stopwatch.js"></script>
  <script src="public/js/quiz.js"></script>

  <script type="text/javascript">
  var timer;
  var timerCurrent;
  var timerFinish;
  var timerSeconds;
  var percent;
  function drawTimer(percent){
    $('div.spinner').html('<div class="percent"></div><div id="slice"'+(percent > 50?' class="gt50"':'')+'><div class="pie"></div>'+(percent > 50?'<div class="pie fill"></div>':'')+'</div>');
    var deg = 360/100*percent;
    $('#slice .pie').css({
      '-moz-transform':'rotate('+deg+'deg)',
      '-webkit-transform':'rotate('+deg+'deg)',
      '-o-transform':'rotate('+deg+'deg)',
      '-ms-transform':'rotate('+deg+'deg)',
      'transform':'rotate('+deg+'deg)'
    });
    $('.percent').html(Math.round(percent)+'%');
  }
  function stopWatch(){
    var seconds = (timerFinish-(new Date().getTime()))/1000;
    if(seconds <= 0){
      drawTimer(100);
      clearInterval(timer);
      startWatch();
    }else{
      percent = 100-((seconds/timerSeconds)*100);
      drawTimer(percent);
    }
  }

  function startWatch(){
    timerSeconds = $('input[type=hidden]#watch').val();
    timerCurrent = 0;
    timerFinish = new Date().getTime()+(timerSeconds*1000);
    timer = setInterval('stopWatch()',60);
  }

  function updateDisplay() {
    var value = parseInt($('.holder-timer .timer').text(), 10);
    value++;
    console.log(parseInt(percent, 10));
    $('.holder-timer .timer').text(value);
    if (parseInt(percent, 10) >= 99) {
      $('#slice .pie').css({
      '-moz-transform':'rotate('+ 360 + 'deg)',
      '-webkit-transform':'rotate('+ 360 + 'deg)',
      '-o-transform':'rotate('+ 360 + 'deg)',
      '-ms-transform':'rotate('+ 360 + 'deg)',
      'transform':'rotate('+ 360 + 'deg)'
    });

      quiz.timeOut();
    };
  }

  function startTimer() {
    _timer = setInterval(updateDisplay, 1);
  };

  function stopTimer() {
    clearInterval(_timer);
  };
  </script>

</body>
</html>